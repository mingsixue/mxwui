import{COLOR}from"../utils/common";Component({properties:{styleType:{type:String,value:"form"},visible:{type:Boolean,value:!1,observer(e){if(e&&"dialog"==this.data.styleType){let t={};for(let e=0;e<this.data.digit;e++)t["idx"+e]=!1;t.idx0=!0,setTimeout(()=>{this.setData({focusObj:t})},300)}}},phone:{type:Number,value:"",observer(e){e=String(e).replace(/^(\d{3})(\d{4})(\d{4})$/,"$1-$2-$3");this.setData({phoneString:e})}},digit:{type:Number,value:4},countdown:{type:Number,value:60},disabled:{type:String,value:!1},sendBtnColor:{type:String,value:COLOR.THEME_COLOR},confirmBtnText:{type:String,value:"确定"},confirmBtnColor:{type:String,value:COLOR.THEME_COLOR},cursorColor:{type:String,value:COLOR.THEME_COLOR},placeholder:{type:String,value:"请输入验证码"},placeholderColor:{type:String,value:COLOR.PLACEHOLDER_COLOR},labelPosition:{type:String,value:"inline"},label:{type:String,value:""},labelColor:{type:String,value:""},labelAlign:{type:String,value:"left"},leftWidth:{type:Number,value:""},required:{type:Boolean,value:!1},requiredPosition:{type:String,value:"right"},firstIcon:{type:Object,value:{}},lastIcon:{type:Object,value:{}},desc:{type:String,value:""},descColor:{type:String,value:""},showLine:{type:Boolean,value:!1},PLACEHOLDER_COLOR:{type:String,value:COLOR.PLACEHOLDER_COLOR},TEXT_COLOR:{type:String,value:COLOR.TEXT_COLOR}},methods:{handleSend(){this.setData({isSend:!0}),this.countdowns(this.data.countdown),this.triggerEvent("verification_code_send")},countdowns(e){let t=e-1;t<0?(t=0,this.setData({time:t})):(this.setData({time:t}),setTimeout(()=>{this.countdowns(t)},1e3))},handleClose(e){this.triggerEvent("verification_code_close",e.detail)},handleBack(){this.triggerEvent("verification_code_back")},handleConfirm(){var{code:e,digit:t}=this.data;e.length===t&&(this.setData({visible:!1}),this.triggerEvent("verification_code_confirm",{code:e.join("")}))},dealIdx(e){var t=this.data.digit;let i={};for(let e=0;e<t;e++)i["idx"+e]=!1;t-1<e?(i["idx"+e]=!1,this.setData({focusObj:i,holdKeyboard:!1})):e<0||(this.setData({focusObj:i,holdKeyboard:!0}),setTimeout(()=>{i["idx"+e]=!0,this.setData({focusObj:i})},300))},handleInput(e){var t=e.currentTarget.dataset.idx,{code:i=[]}=this.data;e.detail.value?(i[t]=e.detail.value,this.dealIdx(t+1)):(i.splice(t,1),this.dealIdx(t-1));let a=0;i.forEach(e=>{e&&(a+=1)}),this.setData({code:i,len:a})},handleInputCode(e){e=e.detail.value;e.length==this.data.digit&&this.triggerEvent("verification_code_confirm",{code:e})},handleFirstClick(){this.triggerEvent("verification_code_firstIcon")},handleLastClick(){this.triggerEvent("verification_code_lastIcon")}}});